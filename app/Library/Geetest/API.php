<?php
namespace App\Library\Geetest; use Illuminate\Support\Facades\Session; class API { private $geetest_conf = null; public function __construct($sp54f11a) { $this->geetest_conf = $sp54f11a; } public static function get() { $spb3971e = new Lib(config('services.geetest.id'), config('services.geetest.key')); $speb13d0 = time() . rand(1, 10000); $sp5340de = $spb3971e->pre_process($speb13d0); $sp27b5c4 = json_decode($spb3971e->get_response_str()); Session::put('gt_server', $sp5340de); Session::put('gt_user_id', $speb13d0); return $sp27b5c4; } public static function verify($spf1bc2c, $spb323a1, $spd0b055) { $spb3971e = new Lib(config('services.geetest.id'), config('services.geetest.key')); $speb13d0 = Session::get('gt_user_id'); if (Session::get('gt_server') == 1) { $spfe67da = $spb3971e->success_validate($spf1bc2c, $spb323a1, $spd0b055, $speb13d0); if ($spfe67da) { return true; } else { return false; } } else { if ($spb3971e->fail_validate($spf1bc2c, $spb323a1, $spd0b055)) { return true; } else { return false; } } } }