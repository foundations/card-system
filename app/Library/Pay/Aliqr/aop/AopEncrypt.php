<?php
function aliqr_encrypt($spba2cdb, $spbbcdba) { $spbbcdba = base64_decode($spbbcdba); $spba2cdb = trim($spba2cdb); $spba2cdb = addPKCS7Padding($spba2cdb); $spe0b13f = mcrypt_create_iv(mcrypt_get_iv_size(MCRYPT_RIJNDAEL_128, MCRYPT_MODE_CBC), 1); $sp1d5e63 = mcrypt_encrypt(MCRYPT_RIJNDAEL_128, $spbbcdba, $spba2cdb, MCRYPT_MODE_CBC); return base64_encode($sp1d5e63); } function aliqr_decrypt($spba2cdb, $spbbcdba) { $spba2cdb = base64_decode($spba2cdb); $spbbcdba = base64_decode($spbbcdba); $spe0b13f = mcrypt_create_iv(mcrypt_get_iv_size(MCRYPT_RIJNDAEL_128, MCRYPT_MODE_CBC), 1); $sp1d5e63 = mcrypt_decrypt(MCRYPT_RIJNDAEL_128, $spbbcdba, $spba2cdb, MCRYPT_MODE_CBC); $sp1d5e63 = trim($sp1d5e63); $sp1d5e63 = stripPKSC7Padding($sp1d5e63); return $sp1d5e63; } function addPKCS7Padding($spec1cab) { $spec1cab = trim($spec1cab); $sp01deed = mcrypt_get_block_size(MCRYPT_RIJNDAEL_128, MCRYPT_MODE_CBC); $sp25fa7e = $sp01deed - strlen($spec1cab) % $sp01deed; if ($sp25fa7e <= $sp01deed) { $spe643c6 = chr($sp25fa7e); $spec1cab .= str_repeat($spe643c6, $sp25fa7e); } return $spec1cab; } function stripPKSC7Padding($spec1cab) { $spec1cab = trim($spec1cab); $spe643c6 = substr($spec1cab, -1); $spe63642 = ord($spe643c6); if ($spe63642 == 62) { return $spec1cab; } $spec1cab = substr($spec1cab, 0, -$spe63642); return $spec1cab; }