<?php
namespace App\Library\Pay\Youzan\Open; use Exception; class Token { private $clientId; private $clientSecret; private $accessToken; private $refreshToken; private static $requestUrl = 'https://open.youzan.com/oauth/token'; public function __construct($spae2649, $spf9b0fb, $sp5b4958 = null, $spbea108 = null) { $this->clientId = $spae2649; $this->clientSecret = $spf9b0fb; $this->accessToken = $sp5b4958; $this->refreshToken = $spbea108; } public function getToken($sp060035, $sp506eb5 = array()) { $sp636f0e = array(); $sp636f0e['client_id'] = $this->clientId; $sp636f0e['client_secret'] = $this->clientSecret; if ($sp060035 === 'oauth') { $sp636f0e['grant_type'] = 'authorization_code'; $sp636f0e['code'] = $sp506eb5['code']; $sp636f0e['redirect_uri'] = $sp506eb5['redirect_uri']; } elseif ($sp060035 === 'refresh_token') { $sp636f0e['grant_type'] = 'refresh_token'; $sp636f0e['refresh_token'] = $sp506eb5['refresh_token']; } elseif ($sp060035 === 'self') { $sp636f0e['grant_type'] = 'silent'; $sp636f0e['kdt_id'] = $sp506eb5['kdt_id']; } elseif ($sp060035 === 'platform_init') { $sp636f0e['grant_type'] = 'authorize_platform'; } elseif ($sp060035 === 'platform') { $sp636f0e['grant_type'] = 'authorize_platform'; $sp636f0e['kdt_id'] = $sp506eb5['kdt_id']; } return $this->parseResponse(Http::post(self::$requestUrl, $sp636f0e)); } private function parseResponse($spd68d19) { $sp2bb3bd = json_decode($spd68d19, true); if (null === $sp2bb3bd) { throw new Exception('response invalid, data: ' . $spd68d19); } return $sp2bb3bd; } }