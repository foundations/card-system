webpackJsonp([8,28],{"9DA/":function(t,e,n){"use strict";var i,a,o;Object.defineProperty(e,"__esModule",{value:!0}),i={props:{info:{}},components:{categoryAdd:n("2xzk").default},data:function(){return{loading:!1,visible:!0}},watch:{visible:function(t){t||this.$emit("close",!1)}},methods:{handleSubmit:function(){this.$refs.editBox.handleSubmit()},handleClose:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.visible=!1,this.$emit("close",t)}}},a={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-dialog",{attrs:{title:"编辑分类",visible:t.visible},on:{"update:visible":function(e){t.visible=e}}},[n("category-add",{ref:"editBox",attrs:{"in-box":!0,info:t.info,loading:t.loading},on:{submit:function(e){t.handleClose(!0)},"update:loading":function(e){t.loading=e}}}),t._v(" "),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{nativeOn:{click:function(e){t.handleClose(!1)}}},[t._v("取消")]),t._v(" "),n("el-button",{attrs:{type:"primary",loading:t.loading},nativeOn:{click:function(e){t.handleSubmit(e)}}},[t._v("确认编辑\n    ")])],1)],1)},staticRenderFns:[]},o=n("VU/8")(i,a,!1,null,null,null),e.default=o.exports},milX:function(t,e,n){"use strict";var i,a,o,l,s,r,c,d,u,h;Object.defineProperty(e,"__esModule",{value:!0}),i=n("woOf"),a=n.n(i),o=n("Y81h"),l=n.n(o),s=n("s8Ph"),r=n("9DA/"),c=n("2xzk"),d={props:{userInfo:{type:Object,default:null},filterType:{default:null},_project:{default:"merchant"}},components:{categoryEdit:r.default,categoryAdd:c.default},data:function(){return{loading:!1,showAddBox:!1,addBoxLoaded:!1,search:{type:"name",value:""},where:{},list:{current_page:1,data:[],from:1,last_page:1,next_page_url:null,per_page:20,prev_page_url:null,to:0,total:0},checkedIds:"",enabledFilter:[{text:"启用",value:1,type:"primary"},{text:"禁用",value:0,type:"info"}],editInfo:null,editAction:null}},watch:{loading:function(t,e){t?e||l.a.isStarted()||l.a.start():l.a.done()}},mounted:function(){this.getList()},methods:{getList:function(){var t=this;this.loading=!0,this.where.current_page=this.list.current_page,this.where.per_page=this.list.per_page,null!==this.filterType&&(this.where.filterType=this.filterType),this.userInfo&&(this.where.user_id=this.userInfo.id),Object(s.c)(this.where).then(function(e){t.list=e.data,t.loading=!1})},handleSearch:function(){var t={search:this.search.type,val:this.search.value};a()(this.where,t),this.getList()},handleFilterChange:function(t){var e={};t.enabled?e.enabled=t.enabled.join(","):e.enabled=null,a()(this.where,e),this.getList()},onChangePage:function(){this.getList()},onChangePageSize:function(t){this.list.per_page=t,this.getList()},goProducts:function(t){this.$router.push({path:"/admin/product/list",query:{category_id:t.id}})},handleSetSort:function(t){var e=this;parseInt(t.sort)!==t.sort_old?(this.loading=!0,Object(s.d)(t.id,t.sort).then(function(){e.getList()}).catch(function(){e.loading=!1})):t.sort=parseInt(t.sort)},handleEdit:function(t){this.editAction="edit",this.editInfo=t},handleDomain:function(t){this.$msgbox({title:"单独链接",message:'<a href="'+t.url+'" target="_blank">'+t.url+"</a>",dangerouslyUseHTMLString:!0})},handleDelete:function(t){var e=this,n=t.name;this.$confirm("删除分类<"+n+">? 此操作不可恢复","提示",{type:"warning"}).then(function(){e.loading=!0,Object(s.a)(t.id).then(function(){e.$notify({title:"操作成功",message:"分类<"+n+">已删除",type:"info"}),e.getList()}).catch(function(){e.loading=!1})})},checkDelete:function(){var t=this;this.checkedIds.length&&this.$confirm("批量删除选中分类? 此操作不可恢复","提示",{type:"warning"}).then(function(){t.loading=!0,Object(s.a)(t.checkedIds).then(function(){t.$notify({title:"操作成功",message:"选中分类已删除",type:"info"}),t.getList()}).catch(function(){t.loading=!1})})},editCallback:function(t){this.editAction=null,t&&this.getList()},handleAdd:function(){var t=this;window.scrollTo(0,0),this.addBoxLoaded=!0,this.$nextTick(function(){t.showAddBox=!t.showAddBox})},onAdd:function(){this.getList(),this.showAddBox=!1}}},u={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{ref:"container",class:{"app-container":!t.userInfo}},[n("el-collapse-transition",[n("div",{directives:[{name:"show",rawName:"v-show",value:t.showAddBox,expression:"showAddBox"}],staticClass:"apply-box"},[n("el-button",{staticStyle:{float:"right",margin:"10px 15px"},attrs:{icon:"el-icon-close",size:"small"},on:{click:function(e){t.showAddBox=!1}}}),t._v(" "),t.showAddBox||t.addBoxLoaded?n("el-card",{staticClass:"my-card"},[n("category-add",{attrs:{"in-box":!0,userInfo:t.userInfo},on:{submit:t.onAdd}})],1):t._e()],1)]),t._v(" "),n("el-col",{staticClass:"no-bottom-form",staticStyle:{"padding-bottom":"0px"},attrs:{span:24}},[n("el-form",{staticClass:"list-pre-table",attrs:{inline:!0}},[n("el-form-item",{staticClass:"mobile-full-width"},[n("el-input",{attrs:{placeholder:"请输入",size:"small"},model:{value:t.search.value,callback:function(e){t.$set(t.search,"value",e)},expression:"search.value"}},[n("el-select",{staticStyle:{width:"90px"},attrs:{slot:"prepend",placeholder:"搜索类型",value:"",size:"small"},slot:"prepend",model:{value:t.search.type,callback:function(e){t.$set(t.search,"type",e)},expression:"search.type"}},[n("el-option",{attrs:{label:"ID",value:"id"}}),t._v(" "),n("el-option",{attrs:{label:"名称",value:"name"}})],1)],1)],1),t._v(" "),n("el-form-item",{staticClass:"fix-height"},[n("el-button",{attrs:{size:"small"},on:{click:t.handleSearch}},[t._v("搜索")])],1),t._v(" "),n("el-form-item",{staticStyle:{float:"right","margin-right":"0"}},[n("a",{staticClass:"icon-btn",on:{click:t.handleAdd}},[n("icon",{attrs:{name:"plus"}}),t._v(" 添加")],1)])],1)],1),t._v(" "),n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"list-table",attrs:{data:t.list.data,stripe:"",border:""},on:{"filter-change":t.handleFilterChange,"selection-change":function(e){return t.checkedIds=e.map(function(t){return t.id}).join(",")}}},[n("el-table-column",{attrs:{type:"selection",width:"40"}}),t._v(" "),"admin"===t._project?n("el-table-column",{attrs:{prop:"id",label:"ID",width:"70"}}):t._e(),t._v(" "),"admin"!==t._project||t.userInfo?t._e():n("el-table-column",{attrs:{prop:"user_id",label:"商户ID",width:"70"}}),t._v(" "),n("el-table-column",{attrs:{prop:"name",label:"名称(点击编辑)","min-width":"150","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[n("a",{staticClass:"text-nowrap line-btn",on:{click:function(n){t.handleEdit(e.row)}}},[t._v(t._s(e.row.name))])]}}])}),t._v(" "),n("el-table-column",{attrs:{prop:"enabled",label:"状态",width:"80","column-key":"enabled",filters:t.enabledFilter,"filter-placement":"bottom"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-tag",{attrs:{type:1===e.row.enabled?"primary":"info","close-transition":""}},[t._v("\n          "+t._s(1===e.row.enabled?"启用":"禁用")+"\n        ")])]}}])}),t._v(" "),n("el-table-column",{attrs:{prop:"products_count",label:"商品数",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("a",{staticClass:"line-btn",on:{click:function(n){t.goProducts(e.row)}}},[t._v(t._s(e.row.products_count))])]}}])}),t._v(" "),n("el-table-column",{attrs:{prop:"sort",label:"排序",width:"70"},scopedSlots:t._u([{key:"default",fn:function(e){return["string"==typeof e.row.sort?n("input",{directives:[{name:"model",rawName:"v-model",value:e.row.sort,expression:"scope.row.sort"}],staticClass:"table-input",attrs:{size:"small",title:"排序"},domProps:{value:e.row.sort},on:{blur:function(n){t.handleSetSort(e.row)},keyup:function(n){if(!("button"in n)&&t._k(n.keyCode,"enter",13,n.key))return null;t.handleSetSort(e.row)},input:function(n){n.target.composing||t.$set(e.row,"sort",n.target.value)}}}):t._e(),t._v(" "),"number"==typeof e.row.sort?n("a",{staticClass:"line-btn",on:{click:function(){e.row.sort_old=e.row.sort,e.row.sort=e.row.sort+""}}},[t._v(t._s(e.row.sort))]):t._e()]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"操作",width:"90",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("a",{staticClass:"icon-btn",on:{click:function(n){t.handleDomain(e.row)}}},[t._v("直链")]),t._v(" "),n("a",{staticClass:"icon-btn",staticStyle:{"font-size":"14px"},on:{click:function(n){t.handleEdit(e.row)}}},[n("icon",{attrs:{name:"pencil"}})],1),t._v(" "),n("a",{staticClass:"icon-btn",on:{click:function(n){t.handleDelete(e.row)}}},[n("icon",{attrs:{name:"trash-o"}})],1)]}}])})],1),t._v(" "),n("el-col",{staticClass:"list-after-action",staticStyle:{"padding-top":"8px","text-align":"left"},attrs:{span:24}},[n("el-form",{staticClass:"no-bottom-form",attrs:{inline:!0}},[n("el-form-item",{attrs:{label:"选中"}},[n("el-button",{attrs:{size:"small"},on:{click:t.checkDelete}},[t._v("删除")])],1)],1)],1),t._v(" "),n("el-col",{staticClass:"list-after-action",staticStyle:{"padding-top":"12px","text-align":"right"},attrs:{span:24}},[t.list.total>0?n("el-pagination",{staticClass:"pagination",attrs:{"page-size":20,"page-sizes":[10,20,30,40,50,100],total:t.list.total,"current-page":t.list.current_page,layout:"total, sizes, prev, pager, next, jumper"},on:{"update:currentPage":function(e){t.$set(t.list,"current_page",e)},"current-change":t.onChangePage,"size-change":t.onChangePageSize}}):t._e()],1),t._v(" "),t.editAction?n("category-edit",{attrs:{info:t.editInfo,action:t.editAction,userInfo:t.userInfo},on:{close:t.editCallback}}):t._e()],1)},staticRenderFns:[]},h=n("VU/8")(d,u,!1,null,null,null),e.default=h.exports}});