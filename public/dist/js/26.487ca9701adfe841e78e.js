webpackJsonp([26],{Bdnf:function(e,t,o){"use strict";var i,n,l,s,a,r;Object.defineProperty(t,"__esModule",{value:!0}),i=o("woOf"),n=o.n(i),l=o("4cjj"),s={props:{info:{}},data:function(){return{loading:!1,visible:!0,couponStatus:l.b,couponType:l.c,couponDiscountType:l.a,form:{id:0,product_id:0,coupon:"",type:l.c.TYPE_ONETIME,discount_val:"",discount_type:l.a.AMOUNT,count_all:null,count_used:null,expire_at:null},formRules:{coupon:[{required:!0,message:"请输入卡号",trigger:"blur"}],discount_val:[{required:!0,message:"请输入优惠券面额",trigger:"blur"}]}}},watch:{visible:function(e){e||this.$emit("close",!1)}},mounted:function(){this.form.id=this.info.id,this.form.coupon=this.info.coupon,this.form.status=this.info.status,this.form.discount_type=this.info.discount_type,this.info.discount_type===l.a.AMOUNT?this.form.discount_val=(this.info.discount_val/100).toFixed(2):this.form.discount_val=this.info.discount_val,this.form.type=this.info.type,this.form.count_all=this.info.count_all,this.form.count_used=this.info.count_used,this.form.expire_at=new Date(this.info.expire_at)},methods:{onDiscountTypeChange:function(){this.form.discount_type===l.a.AMOUNT?this.formRules.discount_val=[{required:!0,message:"请输入优惠券面额",trigger:"blur"},{type:"number",min:.01,max:1e7,message:"数字需要在0.01-10000000之间"}]:this.form.discount_type===l.a.PERCENT&&(this.formRules.discount_val=[{required:!0,message:"请输入优惠百分比",trigger:"blur"},{type:"number",min:1,max:100,message:"数字需要在1-100之间"}])},handleSubmit:function(){var e=this;this.$refs.form.validate(function(t){if(t){e.loading=!0;var o=n()({},e.form);o.discount_type===l.a.AMOUNT&&(o.discount_val*=100),o.expire_at&&(o.expire_at=o.expire_at.format("yyyy-MM-dd")),Object(l.f)(o).then(function(){e.loading=!1,e.$notify({title:"提示",message:"编辑优惠券成功",type:"success",duration:3e3}),e.handleClose(!0)}).catch(function(){e.loading=!1})}})},handleClose:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.visible=!1,this.$emit("close",e)}}},a={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("el-dialog",{attrs:{title:"编辑卡号",visible:e.visible},on:{"update:visible":function(t){e.visible=t}}},[o("el-form",{ref:"form",attrs:{model:e.form,"label-width":"80px",rules:e.formRules}},[o("el-form-item",{attrs:{label:"优惠券",prop:"coupon"}},[o("el-input",{attrs:{type:"text",placeholder:"请输入优惠券"},model:{value:e.form.coupon,callback:function(t){e.$set(e.form,"coupon",t)},expression:"form.coupon"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"面额",prop:"discount_val"}},[o("el-input",{attrs:{type:"number",placeholder:"请输入优惠券面额"},model:{value:e.form.discount_val,callback:function(t){e.$set(e.form,"discount_val",e._n(t))},expression:"form.discount_val"}},[o("el-select",{staticStyle:{width:"70px"},attrs:{slot:"append",placeholder:"类型",value:"",size:"small"},on:{change:e.onDiscountTypeChange},slot:"append",model:{value:e.form.discount_type,callback:function(t){e.$set(e.form,"discount_type",t)},expression:"form.discount_type"}},[o("el-option",{attrs:{label:"￥",value:e.couponDiscountType.AMOUNT}}),e._v(" "),o("el-option",{attrs:{label:"%",value:e.couponDiscountType.PERCENT}})],1)],1)],1),e._v(" "),o("el-form-item",{attrs:{label:"类型"}},[o("el-radio-group",{attrs:{size:"small"},model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}},[o("el-radio-button",{attrs:{label:e.couponType.TYPE_ONETIME}},[e._v("一次性")]),e._v(" "),o("el-radio-button",{attrs:{label:e.couponType.TYPE_REPEAT}},[e._v("重复使用")])],1)],1),e._v(" "),e.form.type===e.couponType.TYPE_REPEAT?o("el-form-item",{attrs:{label:"可用",prop:"count_all",rules:[{required:!0,message:"请输入可用次数",trigger:"blur"},{type:"number",min:1,max:1e7,message:"可用次数不能超过10000000"}]}},[o("el-input",{attrs:{type:"number",placeholder:"请输入可用次数"},model:{value:e.form.count_all,callback:function(t){e.$set(e.form,"count_all",e._n(t))},expression:"form.count_all"}}),e._v(" "),o("span",[e._v("当前已使用 "+e._s(e.form.count_used)+"次")])],1):e._e(),e._v(" "),o("el-form-item",{attrs:{label:"过期",prop:"expire_at"}},[o("el-date-picker",{attrs:{type:"datetime",placeholder:"选择过期时间"},model:{value:e.form.expire_at,callback:function(t){e.$set(e.form,"expire_at",t)},expression:"form.expire_at"}})],1)],1),e._v(" "),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{nativeOn:{click:function(t){e.handleClose(!1)}}},[e._v("取消")]),e._v(" "),o("el-button",{attrs:{type:"primary",loading:e.loading},nativeOn:{click:function(t){e.handleSubmit(t)}}},[e._v("确认编辑\n    ")])],1)],1)},staticRenderFns:[]},r=o("VU/8")(s,a,!1,null,null,null),t.default=r.exports}});