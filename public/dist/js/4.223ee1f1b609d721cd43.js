webpackJsonp([4,13,22],{Dz2l:function(t,e){},EhHQ:function(t,e,i){"use strict";var n,o,a;Object.defineProperty(e,"__esModule",{value:!0}),n={props:{info:{}},components:{productAdd:i("32Lh").default},data:function(){return{loading:!1,visible:!0}},watch:{visible:function(t){t||this.$emit("close",!1)}},methods:{handleSubmit:function(){this.$refs.editBox.handleSubmit()},onSubmit:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.visible=!1,this.$emit("close",t)}}},o={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-dialog",{attrs:{title:"编辑商品",visible:t.visible},on:{"update:visible":function(e){t.visible=e}}},[i("product-add",{ref:"editBox",attrs:{"in-box":!0,info:t.info,loading:t.loading},on:{submit:t.onSubmit,"update:loading":function(e){t.loading=e}}}),t._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{nativeOn:{click:function(e){t.handleClose(!1)}}},[t._v("取消")]),t._v(" "),i("el-button",{attrs:{type:"primary",loading:t.loading},nativeOn:{click:function(e){t.handleSubmit(e)}}},[t._v("确认编辑\n    ")])],1)],1)},staticRenderFns:[]},a=i("VU/8")(n,o,!1,null,null,null),e.default=a.exports},MI9C:function(t,e,i){"use strict";var n,o,a,l;Object.defineProperty(e,"__esModule",{value:!0}),n=i("UgCr"),o={props:{info:{},categories:{}},data:function(){return{loading:!1,isMobile:this.$store.state.app.isMobile,visible:!0,form:{id:this.info.id,category_id:this.info.category_id},formRules:{category_id:[{required:!0,message:"请选择商品分类",trigger:"blur"}]}}},watch:{visible:function(t){t||this.$emit("close",!1)}},methods:{handleSubmit:function(){var t=this;this.$refs.form.validate(function(e){e&&(t.loading=!0,Object(n.a)(t.form.id,t.form.category_id).then(function(){t.loading=!1,t.$notify({title:"提示",message:"修改商品分类成功",type:"success",duration:3e3}),t.$emit("close",{category:t.categories.find(function(e){return e.id===t.form.category_id})})}).catch(function(){t.loading=!1}))})},handleClose:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.visible=!1,this.$emit("close",t)}}},a={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-dialog",{attrs:{title:"修改商品分类",visible:t.visible},on:{"update:visible":function(e){t.visible=e}}},[i("el-form",{ref:"form",attrs:{model:t.form,"label-position":t.isMobile?"top":"","label-width":"90px",rules:t.formRules}},[i("el-form-item",{class:t.isMobile?"item-container":"",style:t.isMobile?"margin-top: -32px":"",attrs:{label:"分类",prop:"category_id"}},[i("el-select",{staticStyle:{display:"block"},attrs:{"no-data-text":"请先添加分类"},model:{value:t.form.category_id,callback:function(e){t.$set(t.form,"category_id",e)},expression:"form.category_id"}},t._l(t.categories,function(t){return i("el-option",{key:t.id,attrs:{value:t.id,label:t.name}})}))],1)],1),t._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{nativeOn:{click:function(e){t.handleClose(!1)}}},[t._v("取消")]),t._v(" "),i("el-button",{attrs:{type:"primary",loading:t.loading},nativeOn:{click:function(e){t.handleSubmit(e)}}},[t._v("确认修改\n    ")])],1)],1)},staticRenderFns:[]},l=i("VU/8")(o,a,!1,function(t){i("Dz2l")},null,null),e.default=l.exports},"X7G/":function(t,e,i){"use strict";var n,o,a,l,s,r,c,d,u,h,f,g,p;Object.defineProperty(e,"__esModule",{value:!0}),n=i("woOf"),o=i.n(n),a=i("Y81h"),l=i.n(a),s=i("UgCr"),r=i("s8Ph"),c=i("EhHQ"),d=i("MI9C"),u=i("32Lh"),h=i("gQ7a"),f={props:{userInfo:{type:Object,default:null},filter:{default:null},_project:{default:"merchant"}},components:{productEdit:c.default,productAdd:u.default,productCategory:d.default},data:function(){return{loading:!1,showAddBox:!1,addBoxLoaded:!1,search:{type:"name",value:""},where:{category_id:-1},categories:[{id:-2,name:"加载中"}],list:{current_page:1,data:[],from:1,last_page:1,next_page_url:null,per_page:20,prev_page_url:null,to:0,total:0},checkedIds:"",enabledFilter:[{text:"上架",value:1,type:"primary"},{text:"下架",value:0,type:"info"}],editInfo:null,editCategory:null}},watch:{loading:function(t,e){t?e||l.a.isStarted()||l.a.start():l.a.done()}},mounted:function(){this.$route.query.category_id&&(this.where.category_id=this.$route.query.category_id),this.filter&&this.filter.category_id&&(this.where.category_id=this.filter.category_id),this.handleSearch(),this.getCategories()},methods:{searchByCategory:function(t){this.where.category_id=t,this.handleSearch()},getCategories:function(){var t=this,e={search:"simple",val:"list"};this.userInfo&&(e.user_id=this.userInfo.id),Object(r.c)(e).then(function(e){t.categories=e.data})},getList:function(){var t=this;this.loading=!0,this.where.current_page=this.list.current_page,this.where.per_page=this.list.per_page,this.userInfo&&(this.where.user_id=this.userInfo.id),Object(s.e)(this.where).then(function(e){t.list=e.data,t.loading=!1})},handleSearch:function(){var t={search:this.search.type,val:this.search.value};o()(this.where,t),this.getList()},handleFilterChange:function(t){var e={};t.enabled?e.enabled=t.enabled.join(","):e.enabled=null,o()(this.where,e),this.getList()},onChangePage:function(){this.getList()},onChangePageSize:function(t){this.list.per_page=t,this.getList()},showDescription:function(t){this.$msgbox({title:"商品描述",message:Object(h.b)(t.description),dangerouslyUseHTMLString:!0,customClass:"ann-box"})},goCards:function(t,e){this.$router.push({path:"/admin/product/card/list",query:{type:t,category_id:e.category_id,product_id:e.id}})},handleSetSort:function(t){var e=this;parseInt(t.sort)!==t.sort_old?(this.loading=!0,Object(s.f)(t.id,t.sort).then(function(){e.getList()}).catch(function(){e.loading=!1})):t.sort=parseInt(t.sort)},handleDisable:function(t){var e=this,i=t.name;this.$confirm("下架商品<"+i+">?","提示",{type:"warning"}).then(function(){e.loading=!0,Object(s.d)(t.id,0).then(function(){e.$notify({title:"操作成功",message:"商品<"+i+">已下架",type:"info"}),t.enabled=0,e.loading=!1}).catch(function(){e.loading=!1})})},handleEnable:function(t){var e=this,i=t.name;this.$confirm("上架商品<"+i+">?","提示",{type:"warning"}).then(function(){e.loading=!0,Object(s.d)(t.id,1).then(function(){e.$notify({title:"操作成功",message:"商品<"+i+">已上架",type:"success"}),t.enabled=1,e.loading=!1}).catch(function(){e.loading=!1})})},handleDelete:function(t){var e=this,i=t.name;this.$confirm("删除商品<"+i+">? 此操作不可恢复","提示",{type:"warning"}).then(function(){e.loading=!0,Object(s.b)(t.id).then(function(){e.$notify({title:"操作成功",message:"商品<"+i+">已删除",type:"info"}),e.getList()}).catch(function(){e.loading=!1})})},handleDomain:function(t){this.$msgbox({title:"单独链接",message:'<a href="'+t.url+'" target="_blank">'+t.url+"</a>",dangerouslyUseHTMLString:!0})},checkDelete:function(){var t=this;this.checkedIds.length&&this.$confirm("批量删除选中商品? 此操作不可恢复","提示",{type:"warning"}).then(function(){t.loading=!0,Object(s.b)(t.checkedIds).then(function(){t.$notify({title:"操作成功",message:"选中商品已删除",type:"info"}),t.getList()}).catch(function(){t.loading=!1})})},checkEnable:function(){var t=this;this.checkedIds.length&&this.$confirm("批量上架选中商品? ","提示",{type:"warning"}).then(function(){t.loading=!0,Object(s.d)(t.checkedIds,1).then(function(){t.$notify({title:"操作成功",message:"选中商品已上架",type:"success"}),t.getList()}).catch(function(){t.loading=!1})})},checkDisable:function(){var t=this;this.checkedIds.length&&this.$confirm("批量下架选中商品? ","提示",{type:"warning"}).then(function(){t.loading=!0,Object(s.d)(t.checkedIds,0).then(function(){t.$notify({title:"操作成功",message:"选中商品已下架",type:"info"}),t.getList()}).catch(function(){t.loading=!1})})},handleAdd:function(){this.$router.push("/admin/product/add")},onBoxSubmit:function(t){var e=this;t&&this.getList(),this.showAddBox=!1,this.$nextTick(function(){e.addBoxLoaded=!1,e.editInfo=null})},handleEdit:function(t){var e=this,i=function(){window.scrollTo(0,0),e.editInfo=t,e.addBoxLoaded=!0,e.$nextTick(function(){e.showAddBox=!0})};this.editInfo?(this.onBoxSubmit(!1),this.$nextTick(function(){e.addBoxLoaded=!1,e.$nextTick(function(){i()})})):i()},editCallback:function(t){this.editInfo=null,t&&this.getList()},handleEditCategory:function(t){this.editCategory=t},editCategoryCallback:function(t){t&&t.category&&(this.editCategory.category_id=t.category.id,this.editCategory.category=t.category),this.editCategory=null}}},g={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{ref:"container",class:{"app-container":!t.userInfo}},[i("el-collapse-transition",[i("div",{directives:[{name:"show",rawName:"v-show",value:t.showAddBox,expression:"showAddBox"}],staticClass:"apply-box"},[i("el-button",{staticStyle:{float:"right",margin:"10px 15px"},attrs:{icon:"el-icon-close",size:"small"},on:{click:function(e){t.onBoxSubmit(!1)}}}),t._v(" "),t.showAddBox||t.addBoxLoaded?i("el-card",{staticClass:"my-card"},[i("product-add",{attrs:{"in-box":!0,userInfo:t.userInfo,info:t.editInfo},on:{submit:t.onBoxSubmit}})],1):t._e()],1)]),t._v(" "),i("el-col",{staticClass:"no-bottom-form",staticStyle:{"padding-bottom":"0px"},attrs:{span:24}},[i("el-form",{staticClass:"list-pre-table",attrs:{inline:!0}},[i("el-form-item",{staticClass:"mobile-full-width"},[i("el-select",{staticClass:"mobile-full-width",attrs:{placeholder:"商品分类",size:"small","no-data-text":"无分类数据"},on:{change:t.getList},model:{value:t.where.category_id,callback:function(e){t.$set(t.where,"category_id",e)},expression:"where.category_id"}},[i("el-option",{attrs:{label:"全部",value:-1}}),t._v(" "),t._l(t.categories,function(t){return i("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})],2)],1),t._v(" "),i("el-form-item",{staticClass:"mobile-full-width"},[i("el-input",{attrs:{placeholder:"请输入",size:"small"},model:{value:t.search.value,callback:function(e){t.$set(t.search,"value",e)},expression:"search.value"}},[i("el-select",{staticStyle:{width:"90px"},attrs:{slot:"prepend",placeholder:"搜索类型",size:"small"},slot:"prepend",model:{value:t.search.type,callback:function(e){t.$set(t.search,"type",e)},expression:"search.type"}},[i("el-option",{attrs:{label:"ID",value:"id"}}),t._v(" "),i("el-option",{attrs:{label:"名称",value:"name"}})],1)],1)],1),t._v(" "),i("el-form-item",{staticClass:"fix-height"},[i("el-button",{attrs:{size:"small"},on:{click:t.handleSearch}},[t._v("搜索")])],1),t._v(" "),i("el-form-item",{staticStyle:{float:"right","margin-right":"0"}},[i("a",{staticClass:"icon-btn",on:{click:t.handleAdd}},[i("icon",{attrs:{name:"plus"}}),t._v(" 添加")],1)]),t._v(" "),i("span",{staticStyle:{clear:"both"}})],1)],1),t._v(" "),i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"list-table",attrs:{data:t.list.data,stripe:"",border:""},on:{"filter-change":t.handleFilterChange,"selection-change":function(e){return t.checkedIds=e.map(function(t){return t.id}).join(",")}}},[i("el-table-column",{attrs:{type:"selection",width:"40"}}),t._v(" "),"admin"===t._project?i("el-table-column",{attrs:{prop:"id",label:"ID",width:"70"}}):t._e(),t._v(" "),"admin"!==t._project||t.userInfo?t._e():i("el-table-column",{attrs:{prop:"user_id",label:"商户ID",width:"70"}}),t._v(" "),i("el-table-column",{attrs:{prop:"name",label:"名称(点击查看商品介绍)","min-width":"180","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[i("a",{staticClass:"line-btn",on:{click:function(i){t.showDescription(e.row)}}},[t._v(t._s(e.row.name))])]}}])}),t._v(" "),i("el-table-column",{attrs:{prop:"name",label:"分类(点击修改)","min-width":"100","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[i("a",{staticClass:"line-btn",on:{click:function(i){t.handleEditCategory(e.row)}}},[t._v(t._s(e.row.category?e.row.category.name:"未知#"+e.row.category_id))])]}}])}),t._v(" "),i("el-table-column",{attrs:{prop:"count_sold",label:"已售",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("a",{staticClass:"line-btn",on:{click:function(i){t.goCards("count_sold",e.row)}}},[t._v(t._s(e.row.count_sold))])]}}])}),t._v(" "),i("el-table-column",{attrs:{prop:"count",label:"库存",width:"90"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("a",{staticClass:"line-btn",on:{click:function(i){t.goCards("count",e.row)}}},[t._v(t._s(e.row.count))])]}}])}),t._v(" "),i("el-table-column",{attrs:{prop:"enabled",label:"状态",width:"80","column-key":"enabled",filters:t.enabledFilter,"filter-placement":"bottom"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-tag",{attrs:{type:1===e.row.enabled?"primary":"info","close-transition":""}},[t._v("\n          "+t._s(1===e.row.enabled?"上架":"下架")+"\n        ")])]}}])}),t._v(" "),i("el-table-column",{attrs:{prop:"sort",label:"排序",width:"70"},scopedSlots:t._u([{key:"default",fn:function(e){return["string"==typeof e.row.sort?i("input",{directives:[{name:"model",rawName:"v-model",value:e.row.sort,expression:"scope.row.sort"}],staticClass:"table-input",attrs:{size:"small",title:"排序"},domProps:{value:e.row.sort},on:{blur:function(i){t.handleSetSort(e.row)},keyup:function(i){if(!("button"in i)&&t._k(i.keyCode,"enter",13,i.key))return null;t.handleSetSort(e.row)},input:function(i){i.target.composing||t.$set(e.row,"sort",i.target.value)}}}):t._e(),t._v(" "),"number"==typeof e.row.sort?i("a",{staticClass:"line-btn",on:{click:function(){e.row.sort_old=e.row.sort,e.row.sort=e.row.sort+""}}},[t._v(t._s(e.row.sort))]):t._e()]}}])}),t._v(" "),i("el-table-column",{attrs:{label:"操作",width:"130",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.enabled?i("a",{staticClass:"icon-btn",on:{click:function(i){t.handleDisable(e.row)}}},[t._v("下架")]):i("a",{staticClass:"icon-btn",on:{click:function(i){t.handleEnable(e.row)}}},[t._v("上架")]),t._v(" "),i("a",{staticClass:"icon-btn",on:{click:function(i){t.handleDomain(e.row)}}},[t._v("直链")]),t._v(" "),i("a",{staticClass:"icon-btn",on:{click:function(i){t.handleEdit(e.row)}}},[i("icon",{attrs:{name:"pencil"}})],1),t._v(" "),i("a",{staticClass:"icon-btn",on:{click:function(i){t.handleDelete(e.row)}}},[i("icon",{attrs:{name:"trash-o"}})],1)]}}])})],1),t._v(" "),i("el-col",{staticClass:"list-after-action",staticStyle:{"padding-top":"8px","text-align":"left"},attrs:{span:24}},[i("el-form",{staticClass:"no-bottom-form",attrs:{inline:!0}},[i("el-form-item",{attrs:{label:"选中"}},[i("el-button",{attrs:{size:"small"},on:{click:t.checkDelete}},[t._v("删除")]),t._v(" "),i("el-button",{attrs:{size:"small"},on:{click:t.checkEnable}},[t._v("上架")]),t._v(" "),i("el-button",{attrs:{size:"small"},on:{click:t.checkDisable}},[t._v("下架")])],1)],1)],1),t._v(" "),i("el-col",{staticClass:"list-after-action",staticStyle:{"padding-top":"12px","text-align":"right"},attrs:{span:24}},[t.list.total>0?i("el-pagination",{staticClass:"pagination",attrs:{"page-size":20,"page-sizes":[10,20,30,40,50,100],total:t.list.total,"current-page":t.list.current_page,layout:"total, sizes, prev, pager, next, jumper"},on:{"update:currentPage":function(e){t.$set(t.list,"current_page",e)},"current-change":t.onChangePage,"size-change":t.onChangePageSize}}):t._e()],1),t._v(" "),t.editCategory?i("product-category",{attrs:{categories:t.categories,info:t.editCategory},on:{close:t.editCategoryCallback}}):t._e()],1)},staticRenderFns:[]},p=i("VU/8")(f,g,!1,null,null,null),e.default=p.exports}});